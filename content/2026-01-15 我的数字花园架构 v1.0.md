---
title: "2026-01-15_再次搬家到 Obsidian+Quartz技术备忘录"
date: 2026-01-15
tags:
  - 
---
今天上班又一顿折腾，把 Gridea 升级到了 Obsidian+Quartz
好处是更稳定，更持久。同时重新梳理了日常文字管理的逻辑。



---

# 🛠️ 我的数字花园架构 v1.0

> 核心理念：本地优先 (Local-First)、数据自治、自动化部署、输入输出分离。
> 
> 状态：已上线
> 
> 更新时间：2026-01-15

## 1. 核心架构图

我的博客系统放弃了传统的 Wordpress/Hexo 方案，采用了更现代、更极客的**分离式架构**：

- **大脑 (CMS)**：Obsidian (本地 Markdown 编辑)
    
- **引擎 (SSG)**：Quartz v4 (基于 Node.js 的静态网站生成器)
    
- **仓库 (Host)**：GitHub (代码托管) + GitHub Pages (网页服务)
    
- **管道 (CI/CD)**：GitHub Actions (自动化构建与部署)
    

## 2. 桌面端工作流 (Mac)

这是我的主力生产环境，所有的深度写作、排版、发布都在此完成。

### 2.1 写作环境

- **工具**：Obsidian
    
- **目录结构**：
    
    - `content/`：存放所有 Markdown 文章。
        
    - `content/Templates/`：存放 YAML Frontmatter 模板，用于规范化标题和日期。
        
    - `content/index.md`：自定义的博客门户首页。
        
- **排版增强**：自定义了 `custom.scss`，实现了卡片悬浮、毛玻璃侧栏等高级视觉效果。
    

### 2.2 自动化发布脚本 (`qsync`)

为了解决国内网络连接 GitHub 不稳定的问题，以及简化发布流程，我在 Zsh 中配置了自定义函数 `qsync`。

**脚本逻辑：**

1. 自动定位到博客所在的物理路径（解决路径依赖问题）。
    
2. 自动检测本地 ClashX 代理端口 (7890)。
    
3. 如果有代理，自动配置 Git 网络环境；如果没有，则直连。
    
4. 执行 `npx quartz sync`，一键完成 Commit、Push 和 Sync。
    

**当前脚本配置 (`~/.zshrc`)：**

Bash

```
function qsync() {
    # 强制定位到博客目录
    cd /Users/cchi_documents/Documents/quartz-blog || return 

    # 智能代理检测
    if lsof -Pi :7890 -sTCP:LISTEN -t >/dev/null ; then
        echo "🚀 检测到 ClashX 已开启，正在挂载代理加速..."
        export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890
    else
        echo "🐢 未检测到代理，将尝试直连..."
        unset https_proxy http_proxy all_proxy
    fi
    
    # 执行同步
    npx quartz sync
}
```

注意：
## 修改配置文件以保证部分内容不被推送

`在项目根目录下找到 quartz.config.ts 文件。`

`定位到 configuration 部分的 ignorePatterns 字段。`

`在这个数组中添加你想要排除的文件夹名称。`

`示例代码如下：`

`ignorePatterns: ["done", "private", "templates", ".obsidian", "插件生成的文件夹名"]`

`Quartz 在构建网页时会自动跳过这些目录。`

### 2.3 评论系统

- **方案**：Giscus
    
- **原理**：基于 GitHub Discussions API。
    
- **优势**：无广告、免费、数据完全掌控在自己的 GitHub 仓库中。
    
- **配置**：已集成在 `quartz.layout.ts` 的 `afterBody` 区域，位于文章正文下方。
    

---

## 3. 移动端工作流 (iOS)

为了避免手机端处理 `node_modules` 黑洞带来的性能灾难，移动端采用**“输入/查看分离”**策略。

### 3.1 极速捕获 (Capture)

- **工具**：iOS 快捷指令 (Shortcuts) + iCloud Drive
    
- **逻辑**：
    
    1. 通过操作按钮或桌面组件触发“闪念胶囊”。
        
    2. 输入文字（或语音转文字）。
        
    3. 系统直接将内容追加写入到 iCloud Drive 中的 `inbox.txt` 文件。
        
- **优势**：毫秒级启动，无需打开任何 App，零延迟，不丢数据。
    

### 3.2 查看与整理 (Review)

- **工具**：Taio 或 Obsidian (卫星库模式)
    
- **模式**：
    
    - 在手机上**不打开**博客主库。
        
    - 只打开包含 `inbox.txt` 的文件夹。
        
- **操作**：在手机上对灵感进行简单的增删改，数据通过 iCloud 自动同步回电脑。电脑端 Obsidian 读取 `inbox.txt` 进行深度加工。
    

### 3.3 富媒体缓冲区

- **工具**：Apple Notes (备忘录)
    
- **用途**：
    
    - **扫描仪**：纸质文档数字化 (OCR)。
        
    - **画板**：手绘草图、思维导图。
        
    - **生活隔离区**：家庭共享清单、证件照等不进入博客库的信息。
        

---

## 4. 部署与运维

### 4.1 GitHub Actions

- **配置文件**：`.github/workflows/deploy.yml`
    
- **优化策略**：
    
    - 开启了 `cancel-in-progress: true`。
        
    - **作用**：当有多次连续提交时，自动杀掉前面正在排队的旧任务，只部署最新版本，防止流水线阻塞。
        

### 4.2 域名与访问

- 托管于 GitHub Pages。
    
- 全站支持 HTTPS 和 HTTP/2。
    

---

## 5. 下一步计划

- [ ] 持续优化首页 `index.md` 的内容组织。
    
- [ ] 丰富 `Templates`，增加读书笔记、投资复盘等专用模板。
    
- [ ] 定期检查 Quartz 版本更新。